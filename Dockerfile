FROM ansibleplaybookbundle/apb-base

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IG9wZW53aGlzay1zZXJ2aWNlLWFwYgpkZXNjcmlwdGlvbjogPgog\
IEFwYWNoZSBPcGVuV2hpc2sgaXMgYSBzZXJ2ZXJsZXNzLCBvcGVuIHNvdXJjZSBjbG91ZCBwbGF0\
Zm9ybSB0aGF0CiAgZXhlY3V0ZXMgZnVuY3Rpb25zIGluIHJlc3BvbnNlIHRvIGV2ZW50cyBhdCBh\
bnkgc2NhbGUuCmJpbmRhYmxlOiBUcnVlCmFzeW5jOiBvcHRpb25hbAp0YWdzOgogIC0gRmFhUwog\
IC0gT3BlbldoaXNrCiAgLSBtb2JpbGUtc2VydmljZQogIC0gbW9iaWxlLWNsaWVudC1lbmFibGVk\
Cm1ldGFkYXRhOgogIGRpc3BsYXlOYW1lOiBBcGFjaGUgT3BlbldoaXNrCiAgaW1hZ2VVcmw6IGh0\
dHBzOi8vZ2l0aHViLmNvbS9hcGFjaGUvaW5jdWJhdG9yLW9wZW53aGlzay9ibG9iL21hc3Rlci9k\
b2NzL2ltYWdlcy93aGlza19pY29uX2Z1bGwtY29sb3Jfd2l0aF90bV8xMjh4MTI4LTMwMGRwaS5w\
bmc/cmF3PXRydWUKICBkb2N1bWVudGF0aW9uVXJsOiBodHRwczovL29wZW53aGlzay5hcGFjaGUu\
b3JnLwogIHNlcnZpY2VOYW1lOiBhcGFjaGUtb3BlbndoaXNrCiAgZGVwZW5kZW5jaWVzOiBbXQpw\
bGFuczoKICAtIG5hbWU6IGRlZmF1bHQKICAgIGRlc2NyaXB0aW9uOiBUaGlzIGRlZmF1bHQgcGxh\
biBkZXBsb3lzIG9wZW53aGlzay1zZXJ2aWNlCiAgICBmcmVlOiBUcnVlCiAgICBtZXRhZGF0YTog\
e30KICAgIHBhcmFtZXRlcnM6IFtdCiAgICBiaW5kX3BhcmFtZXRlcnM6CiAgICAgIC0gbmFtZTog\
YWN0aW9uX2lkCiAgICAgICAgdGl0bGU6IFRoZSBuYW1lIG9mIHRoZSBPcGVuV2hpc2sgYWN0aW9u\
X2lkCiAgICAgICAgdHlwZTogc3RyaW5nCiAgICAgICAgZGVmYXVsdDogJycKICAgICAgICByZXF1\
aXJlZDogVHJ1ZQogICAgICAtIG5hbWU6IGFjdGlvbgogICAgICAgIHRpdGxlOiBEZWZpbmUgdGhl\
IGFjdGlvbiBpbiBKYXZhU2NyaXB0IChOb2RlLmpzIDYgUnVudGltZSkKICAgICAgICB0eXBlOiBz\
dHJpbmcKICAgICAgICBkaXNwbGF5X3R5cGU6IHRleHRhcmVhCiAgICAgICAgZGVmYXVsdDogJycK\
ICAgICAgICByZXF1aXJlZDogVHJ1ZQogICAgICAtIG5hbWU6IGNsaWVudF9pZAogICAgICAgIHRp\
dGxlOiBNb2JpbGUgQ2xpZW50IElkZW50aWZpZXIKICAgICAgICB0eXBlOiBzdHJpbmcKICAgICAg\
ICBkZWZhdWx0OiAnJwogICAgICAgIHJlcXVpcmVkOiBUcnVlCg=="

COPY playbooks /opt/apb/actions
COPY roles /opt/ansible/roles
RUN chmod -R g=u /opt/{ansible,apb}
USER apb
